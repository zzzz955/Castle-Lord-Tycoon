# 장비 시스템

## 개요
- 장비는 영웅 능력치를 직접적으로 상승시켜 전투력을 끌어올리는 핵심 성장 콘텐츠다.
- 장비 종류: 무기, 모자, 갑옷, 신발, 목걸이, 반지, 벨트. 반지는 두 개까지 착용 가능해 모든 영웅은 총 8개의 장비 슬롯을 가진다.
- 모든 장비는 등급(C/UC/R/H/L)과 착용 가능 레벨(1/35/64/99/120/160/200)에 따라 기본 능력치가 고정값으로 정의된다.
- 등급 색상: C=흰색, UC=연두색, R=어두운 노란색, H=보라색, L=진한 주황색.
- 장비가 제공하는 스탯 풀: 공격력, 체력, 방어력, 회피율, 크리티컬 확률, 크리티컬 데미지, 방어도 무시.
- 영웅 타입 제한 없이 어떤 영웅이라도 모든 장비를 착용할 수 있다.

## 기본 능력치
- 장비마다 기본 상승 수치가 있으며 등급·레벨 조합별로 고정값이다.
- 장비 착용 시 해당 기본 수치가 곱연산이 아닌 “더하기” 방식으로 영웅 능력치에 적용된다.

### 부가 능력치(UC 이상)
- C 등급은 기본 능력치만 제공한다.
- UC 이상은 등급에 따라 부가 능력치가 추가된다:
  - UC: 1개
  - R: 2개
  - H: 3개
  - L: 4개
- 부가 능력치는 지정된 7개 스탯 풀(공/체/방/회피/크확/크뎀/방무) 중에서 중복 허용으로 랜덤 선택된다.
- 각 부가 능력치 수치는 “동일 레벨·등급 장비의 기본 수치 절반”을 기준값으로 하고, 그 값의 `±20%` 범위에서 균일하게 랜덤 부여된다.
  - 예: Lv1 UC ‘녹슨 검’ 기본 공격력 12라면, 부가 스탯은 기준 6을 중심으로 4.8~7.2 범위에서 산출된다(소수 처리 규칙은 추후 정의).
  - 다른 부위의 스탯(예: 갑옷 기본 방어력)을 부가 능력치로 부여하는 것도 허용된다.
- UI에서는 기본 능력치와 부가 능력치를 구분해 표시한다.

## 장비 종류별 기본 효과
- **무기**: 기본 공격력 증가.
- **모자**: 기본 체력 증가.
- **갑옷**: 기본 방어력 증가.
- **신발**: 기본 회피율 증가.
- **목걸이**: 크리티컬 확률 증가.
- **반지**: 크리티컬 데미지 증가.
- **벨트**: 방어도 무시 증가.

## 보석 각인
- 모든 장비는 기본적으로 보석 슬롯 1개가 열린 상태로 드롭된다.
- 최대 4개 슬롯까지 확장 가능하며, 추가 슬롯 해금 시 골드를 소모한다.
- 슬롯 해금 비용은 레벨/등급별로 정의된 테이블(`equipment_socket_unlock.csv` 등)로 관리한다.
- 보석 장착/해제 규칙은 별도 문서에서 정의 예정(Stub).

## 장비 강화
- 모든 장비는 최대 +20까지 강화 가능하다.
- 강화 성공 시 현재 능력치에 1.1배 곱을 적용한다(누적 곱연산). 20강 시 약 6.7275배까지 상승한다.
- 강화 성공 확률(현재 단계 기준):
  - 0~4강 → +1 시도: 100%
  - 5~9강 → +1 시도: 50%
  - 10~14강 → +1 시도: 30%
  - 15~19강 → +1 시도: 10%
- 강화 실패 시 단계가 1 하락한다(예: 10강 → 9강).
- 강화 비용은 레벨/등급별 골드 소모 테이블(`equipment_upgrade_cost.csv`)로 관리한다.
- 보호석 사용 시 실패해도 단계 하락이 없으며, 성공해도 보호석은 소모된다. 보호석은 현재 드랍 전용이며, 추후 상점 판매 여부는 미정.

## 장비 판매
- 장비 판매 시 구매가의 25%에 해당하는 골드를 돌려준다.
- 판매 가격은 상점 데이터(csv) 기반으로 계산한다(`shop_inventory.csv` 등).

## 장비 분해
- 장비를 분해하면 별도의 재화는 주어지지 않는다.
- 장비에 각인된 보석이 있을 경우 모두 반환된다.
- 분해 데이터 및 UI 로직은 별도 문서에서 세부 정의 예정(Stub).

## 데이터 관리
- 주요 CSV 후보:
  - `equipment_base_stats.csv`: 레벨/등급/부위별 기본 능력치.
  - `equipment_grade_rules.csv`: 등급별 부가 능력치 개수, 색상 정보.
  - `equipment_substat_ranges.csv`: 부가 능력치 기준 및 ±20% 범위 정의.
  - `equipment_socket_unlock.csv`: 각인 슬롯 해금 비용(골드).
  - `equipment_upgrade_cost.csv`: 강화 비용 테이블.
  - `shop_inventory.csv`: 상점 판매가 및 재고.
- 보호석 드랍 및 획득 경로는 전리품/이벤트 테이블에서 관리한다.

## 남은 과제 / Stub
1. 부가 능력치 수치의 소수 처리 규칙(반올림, 버림 등) 결정.
2. 보호석 드랍 확률 및 공급처 정의.
3. 보석 종류/효과, 슬롯 확장 UI/UX 구체화.
4. 장비 분해 UI와 다중 분해 편의 기능 설계.
5. 강화 비용/확률 CSV와 상점 CSV(판매가) 구체화.

---
**최종 수정**: 2025-10-23  
**상태**: 개편  
**작성자**: SangHyeok  
