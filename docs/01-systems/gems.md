# 보석 시스템 기획서

## 1. 개요
- 보석은 장비에 각인해 영웅의 핵심 능력치(공격력/방어력/체력/크리티컬 확률/크리티컬 데미지/방어도 무시/피해 감소율)를 **퍼센트 단위**로 강화하는 성장 수단이다.
- 색상과 능력치 매핑
  | 색상 | 능력치 | 장착 가능 장비 |
  | --- | --- | --- |
  | 빨강 | 공격력 | 무기 |
  | 파랑 | 방어력 | 갑옷 |
  | 연두 | 체력 | 모자 |
  | 노랑 | 크리티컬 확률 | 목걸이 |
  | 분홍 | 크리티컬 데미지 | 반지 |
  | 보라 | 방어도 무시 | 벨트 |
  | 청록 | 피해 감소율 | 신발 |
- 등급과 색상은 장비와 동일한 5단계(C/UC/R/H/L)이며, 보너스 수치는 고정값이다.

| 등급 | 공격/방어/체력 | 크확/크뎀/방무/피해 감소 |
| --- | --- | --- |
| C | +3% | +2% |
| UC | +6% | +4% |
| R | +9% | +6% |
| H | +12% | +8% |
| L | +15% | +10% |

> 수치는 내부적으로 고정소수(×100 기준)로 저장하며, UI에서 %로 표시한다.

## 2. 장착 규칙
- 모든 장비는 기본적으로 **보석 슬롯 1개가 열려 있고, 추가 5개**를 골드로 해금할 수 있다 → 총 6개 슬롯.
- 슬롯 해금 비용은 `equipment_socket_unlock.csv`에 추가 슬롯별 5단계(슬롯 2~6)로 정의한다.
- 보석은 해당 장비 전용 색상만 장착 가능(예: 빨강 보석은 무기에만 장착). 시스템 차원의 검증을 필수로 거친다.
- 장착/해제:
  - 장착은 슬롯이 열려 있고 동일 색상 규칙을 만족할 때만 가능.
  - 보석 해제는 **장비 분해** 시에만 가능하며, 장비는 소멸하고 보석만 반환된다.

## 3. 획득 경로
- **일일 상점 – 보석 탭**: 제한된 수량/갱신 방식으로 판매. 품목은 BOP(구체 수치는 `shop_inventory.csv` 확장 예정).
- **필드 드랍**: `enemy_drop_tables.csv`에서 보석 아이템을 지정해 확률성 획득. 필드별로 등급 분포를 조절한다.

## 4. 조합 시스템
- 같은 등급의 보석 2개를 소모해 상위 등급 보석 1개를 제작 가능.
- 조합 성공 확률 및 골드 소모량은 `gem_combination_rules.csv`에서 정의한다.
  | 입력 | 출력 | 성공 확률 | 골드 소모 |
  | --- | --- | --- | --- |
  | C + C | UC | 70% | 100골드 |
  | UC + UC | R | TBD | TBD |
  | R + R | H | TBD | TBD |
  | H + H | L | 30% | 2,000골드 |
- 실패 시 재료만 소모되고 결과물은 생성되지 않는다(기본 규칙). 필요 시 보호 아이템을 추가하는 확장 여지를 남겨둔다.
- UX 개선(자동 조합, 연속 조합)은 추후 구현을 위한 Stub 상태로 유지한다.

## 5. 데이터 구조 제안
| 파일 | 컬럼 예시 | 설명 |
| --- | --- | --- |
| `gem_templates.csv` | `gem_id`, `color`, `stat_type`, `grade`, `value_percent`, `name_token_ko`, `description_token_ko` | 보석 정의 |
| `gem_drop_tables.csv` | `drop_id`, `gem_id`, `rate`, `amount_min`, `amount_max`, `source` | 필드/상점 확률 |
| `gem_combination_rules.csv` | `input_grade`, `output_grade`, `success_rate`, `gold_cost` | 조합 규칙 |
| `equipment_socket_unlock.csv` | `slot_index`, `gold_cost` | 슬롯 해금 비용(장비 문서 연동) |

## 6. Stub / 남은 과제
1. 조합 성공 확률 및 골드 소모 상세 수치(R/R, UC/UC 등) 확정.
2. 필드 드랍 확률과 일일 상점 품목 구성 밸런스 조정.
3. 자동 조합 UX 설계 및 구현 계획.
4. 보석 UI(장착/해제/조합) 와이어프레임 정의.

---
**최종 수정**: 2025-10-23  
**상태**: 초안  
**작성자**: SangHyeok  
