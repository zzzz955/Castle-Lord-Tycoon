# ì „íˆ¬ ì‹œìŠ¤í…œ

## ê°œìš”

```yaml
type: "ì™„ì „ ìë™ ì „íˆ¬"
grid: "3Ã—3"
max_party: 4
element_system: true
element_modifier: "Â±30%"
round_limit: 10
```

**í•µì‹¬ ê°€ì¹˜**: ë°°ì¹˜ì™€ ìƒì„±ìœ¼ë¡œ ì „ëµì„ ë§Œë“œëŠ” ë‹¨ìˆœí•˜ì§€ë§Œ ê¹Šì´ ìˆëŠ” ì „íˆ¬

## ê·¸ë¦¬ë“œ ì‹œìŠ¤í…œ

### 3Ã—3 ë°°ì¹˜
```
[7] [4] [1]   ìš°ì¸¡ ìƒë‹¨(1) â†’ ìš°ì¸¡ ì¤‘ë‹¨(2) â†’ ìš°ì¸¡ í•˜ë‹¨(3)
[8] [5] [2]   ì¤‘ì•™ ìƒë‹¨(4) â†’ ì¤‘ì•™ ì¤‘ë‹¨(5) â†’ ì¤‘ì•™ í•˜ë‹¨(6)
[9] [6] [3]   ì¢Œì¸¡ ìƒë‹¨(7) â†’ ì¢Œì¸¡ ì¤‘ë‹¨(8) â†’ ì¢Œì¸¡ í•˜ë‹¨(9)
```

**í–‰ë™ ìš°ì„ ìˆœìœ„**: ë²ˆí˜¸ ìˆœì„œëŒ€ë¡œ (1â†’2â†’3â†’4â†’5â†’6â†’7â†’8â†’9)

```yaml
placement_rules:
  - ìµœëŒ€ 4ëª…ê¹Œì§€ ë°°ì¹˜ ê°€ëŠ¥
  - ë¹ˆ ì¹¸ í—ˆìš©
  - ë°°ì¹˜ ìˆœì„œê°€ ì „ëµì˜ í•µì‹¬
  - ì ë„ ë™ì¼í•œ ê·œì¹™ ì ìš©, ë‹¨ UIìƒ í”Œë ˆì´ì–´ì™€ ì¢Œìš° ë°˜ì „ë˜ì–´ ë³´ì„
```

### ì „ëµì  ë°°ì¹˜

```yaml
front_positions: [1, 2, 3]  # ì ì—ê²Œ ê°€ê¹Œì›€, ë¨¼ì € ê³µê²©ë°›ìŒ
mid_positions: [4, 5, 6]    # ê· í˜•ì¡íŒ ìœ„ì¹˜
back_positions: [7, 8, 9]   # ì•ˆì „í•˜ì§€ë§Œ ëŠ¦ê²Œ í–‰ë™
```

## ì „íˆ¬ íë¦„

### 1. ì¡°ìš° ë°œìƒ
```
í•„ë“œ ì´ë™ â†’ íƒ€ì¼ íƒœê·¸ ì²´í¬ â†’ í™•ë¥  íŒì • â†’ ì „íˆ¬ ëŒì…
```

### 2. ì „íˆ¬ ì‹œì‘
```yaml
combat_initialization:
  - íŒŒí‹° ë°°ì¹˜ í™•ì •
  - ì  ë°°ì¹˜ ìƒì„±
  - ë¼ìš´ë“œ ì¹´ìš´í„° ì´ˆê¸°í™” (0/10)
```

### 3. ë¼ìš´ë“œ ì§„í–‰

```yaml
ì „íˆ¬ ìŠ¤ëƒ…ìƒ· ìƒì„±:
  - ì„œë²„ê°€ í˜„ì¬ ì˜ì›… ê¸°ë³¸ ìŠ¤íƒ¯ ì¡°íšŒ
  - ì¥ë¹„ ë³´ë„ˆìŠ¤ ì ìš©í•˜ì—¬ ìµœì¢… ìŠ¤íƒ¯ ê³„ì‚°
    * Base Stats (HP, Attack, Defense)
    * Extended Stats (crit_rate, crit_damage, evasion, etc.)
    * Flat Bonuses: stat + equipment_flat_bonus
    * Percent Bonuses: result Ã— (1 + equipment_percent_bonus)
  - ì „íˆ¬ ì „ìš© ìŠ¤ëƒ…ìƒ· ìƒì„± (ë¶ˆë³€)
  - ì•„êµ° ë²„í”„/ì êµ° ë””ë²„í”„ ì ìš© (Aura ê³ ìœ  íš¨ê³¼)

ê° ë¼ìš´ë“œ:
  1. í”Œë ˆì´ì–´ ì„ ê³µ í›„ 1í„´ì”© ê³µê²©ì„ ì£¼ê³  ë°›ìŒ
  2. ìš°ì„ ìˆœìœ„ ìˆœì„œëŒ€ë¡œ í–‰ë™ (1â†’9)
  3. ê° ìœ ë‹›:
     - ìƒì¡´ ì—¬ë¶€ ì²´í¬ (ì „íˆ¬ ì¤‘ ì‚¬ë§í•œ ê¸°ë¬¼ì˜ í„´ì€ ìŠ¤í‚µ, ìŠ¤í‚µëœ ê²½ìš° ìƒëŒ€ë°©ì˜ í„´ìœ¼ë¡œ ë„˜ì–´ê°)
     - íƒ€ê²Ÿ ì„ íƒ (ìš°ì„  ê³µê²© ë“± íš¨ê³¼ê°€ ì—†ì„ ê²½ìš° ìì‹ ê³¼ ê°™ì€ í–‰ì˜ ë§¨ ì• ê¸°ë¬¼ì„ íƒ€ê²Ÿìœ¼ë¡œ ê³µê²©, ê°™ì€ í–‰ì— íƒ€ê²Ÿì´ ì—†ì„ ê²½ìš° ìœ„ìª½ í–‰ ìš°ì„  íƒ€ê²©, ìœ„ìª½ í–‰ì—ë„ ê¸°ë¬¼ì´ ì—†ì„ ê²½ìš° ì•„ë˜ìª½ í–‰ íƒ€ê²©)
     - ë°ë¯¸ì§€ ê³„ì‚° (ì†ì„± ìƒì„± + ê³ ìœ  íš¨ê³¼ ì ìš©)
     - ë°ë¯¸ì§€ ì ìš©
     - ê³ ìœ  íš¨ê³¼ ë°œë™ (í¡í˜ˆ, í”¼í•´ ê°ì†Œ, ë°˜ì‚¬ í”¼í•´, ë³´í˜¸ë§‰ ë“±)
  4. ì–‘ì¸¡ ì „ë©¸ ì²´í¬
  5. ë¼ìš´ë“œ ì¦ê°€

ìŠ¤íƒ¯ ê²€ì¦:
  - ì„œë²„ ê³„ì‚° ìŠ¤íƒ¯ìœ¼ë¡œ ì „íˆ¬ ì‹œë®¬ë ˆì´ì…˜ (Server Authoritative)
  - í´ë¼ì´ì–¸íŠ¸ ìŠ¤íƒ¯ì€ UI í‘œì‹œìš©
  - ì „íˆ¬ ì‹œì‘ ì‹œ ì„œë²„-í´ë¼ì´ì–¸íŠ¸ ìŠ¤íƒ¯ ë¶ˆì¼ì¹˜ ê²€ì¦
  - ë¶ˆì¼ì¹˜ ì‹œ ì„œë²„ ê°’ ì‚¬ìš© ë° í´ë¼ì´ì–¸íŠ¸ ë™ê¸°í™”
```

### 4. ì „íˆ¬ ì¢…ë£Œ
```yaml
win_condition: "ì  ì „ë©¸"
lose_condition: "ì•„êµ° ì „ë©¸ ë˜ëŠ” ë¼ìš´ë“œ 10 ì´ˆê³¼"
draw_condition: "ë¼ìš´ë“œ 10ì—ì„œ ì–‘ì¸¡ ìƒì¡´"

round_11_penalty:
  - 11ë¼ìš´ë“œë¶€í„° ì–‘ì¸¡ ë°ë¯¸ì§€ ì¦ê°€
  - ë§¤ ë¼ìš´ë“œ 10%ì”© ê°€ì†
  - ê°•ì œ ì¢…ë£Œ ìœ ë„
```

## ì†ì„± ì‹œìŠ¤í…œ

### 4ì†ì„± ìƒì„±

```yaml
elements:
  water: "ë¬¼"
  fire: "ë¶ˆ"
  earth: "ë•…"
  none: "ë¬´ì†ì„±"

advantage_table:
  water > fire: "+30% damage"
  fire > earth: "+30% damage"
  earth > water: "+30% damage"
  none: "Â±0% (ì¤‘ë¦½)"

disadvantage_table:
  water < earth: "-30% damage"
  fire < water: "-30% damage"
  earth < fire: "-30% damage"
```

### ë°ë¯¸ì§€ ê³„ì‚°

```yaml
formula:
  step_1_armor_penetration: "ë°©ì–´ë ¥ Ã— (1 - ë°©ì–´ë„ ë¬´ì‹œ)"
  step_2_base_damage: "ê³µê²©ë ¥ - ê°ì†Œëœ ë°©ì–´ë ¥ (ìµœì†Œ 1)"
  step_3_element_bonus: "Â±30% (ì†ì„± ìƒì„±)"
  step_4_crit_check: "í¬ë¦¬í‹°ì»¬ íŒì •"
  step_5_evasion_check: "íšŒí”¼ íŒì • (íšŒí”¼ ë¬´ì‹œ ê³ ë ¤)"
  step_6_unique_effects: "ê³ ìœ  íš¨ê³¼ ì ìš©"
  step_7_final_damage: "ìµœì¢… í”¼í•´"

detailed_calculation:
  1. ë°©ì–´ë ¥ ê°ì†Œ: defense Ã— (1 - armor_penetration)
  2. ê¸°ë³¸ í”¼í•´: max(1, attack - reduced_defense)
  3. ì†ì„± ë³´ë„ˆìŠ¤: base_damage Ã— (1 + element_modifier)
  4. í¬ë¦¬í‹°ì»¬:
     - í™•ë¥ : crit_rate
     - í”¼í•´: damage Ã— (1 + crit_damage)
  5. íšŒí”¼:
     - í™•ë¥ : evasion Ã— (1 - evasion_pierce)
     - ì„±ê³µ ì‹œ: damage = 0 (Miss)
  6. ê³ ìœ  íš¨ê³¼:
     - ì¶”ê°€ í”¼í•´, í”¼í•´ ì¦ê°€ ë“±
  7. ìµœì¢… í”¼í•´:
     - ë°›ëŠ” í”¼í•´ ê°ì†Œ: damage Ã— (1 - damage_reduction)
     - ë¸”ë¡: damage Ã— 0.5 (í™•ë¥  íŒì •)

example:
  attacker: "ê³µê²©ë ¥ 100, ë¶ˆ ì†ì„±, ë°©ì–´ë„ ë¬´ì‹œ 20%"
  defender: "ë°©ì–´ë ¥ 30, ë•… ì†ì„±, ë°›ëŠ” í”¼í•´ ê°ì†Œ 10%"
  calculation:
    step1: "30 Ã— (1 - 0.2) = 24 (ê°ì†Œëœ ë°©ì–´ë ¥)"
    step2: "100 - 24 = 76"
    step3: "76 Ã— 1.3 = 98.8 (ì†ì„± ë³´ë„ˆìŠ¤)"
    step4: "í¬ë¦¬í‹°ì»¬ ë¯¸ë°œë™"
    step5: "íšŒí”¼ ì‹¤íŒ¨"
    step6: "ê³ ìœ  íš¨ê³¼ ì—†ìŒ"
    step7: "98.8 Ã— (1 - 0.1) = 88.92 (ìµœì¢…)"
```

## ë³´ìƒ ì‹œìŠ¤í…œ

### ê²½í—˜ì¹˜ ë¶„ë°°

```yaml
exp_distribution:
  rule: "ìƒì¡´ìë§Œ ê· ë“± ë¶„ë°°"
  calculation: "ì´ ê²½í—˜ì¹˜ / ìƒì¡´ì ìˆ˜"
  dead_heroes: "0 ê²½í—˜ì¹˜"

example:
  total_exp: 360
  survivors: 3
  dead: 1
  result: "ê° ìƒì¡´ì 120 ê²½í—˜ì¹˜, ì‚¬ë§ì 0"
```

### ë“œë ë³´ìƒ

```yaml
drop_system:
  rule: "ìƒì¡´ ì—¬ë¶€ ë¬´ê´€"
  factors:
    - ëª¬ìŠ¤í„° ë“œë í…Œì´ë¸”
    - íŒŒí‹° ë“œëë¥  í•©ì‚° (drop_rate_bonus)
    - ê³„ê¸‰ ë³´ë„ˆìŠ¤

party_bonus_calculation:
  exp: "íŒŒí‹° ì „ì²´ exp_bonus í•©ì‚°"
  gold: "íŒŒí‹° ì „ì²´ gold_bonus í•©ì‚°"
  drop_rate: "íŒŒí‹° ì „ì²´ drop_rate_bonus í•©ì‚°"

  example:
    hero1: "exp +10%, gold +5%"
    hero2: "exp +15%, drop +8%"
    hero3: "gold +12%"
    total: "exp +25%, gold +17%, drop +8%"

  application:
    base_exp: 100
    final_exp: "100 Ã— (1 + 0.25) = 125"
```

## ì „íˆ¬ ê²°ê³¼ ëˆ„ì 

### í•„ë“œ ëˆ„ì  ê·œì¹™

```yaml
accumulated:
  - HP ì†ì‹¤ (ëˆ„ì )
  - ì˜ì›… ì‚¬ë§ ìƒíƒœ (ëˆ„ì )

reset_on_combat_end:
  - ë””ë²„í”„/ë²„í”„
  - ìŠ¤í‚¬ ì¿¨ë‹¤ìš´
  - ì „íˆ¬ ì„ì‹œ ìƒíƒœ

recovery_methods:
  camping: "ì•¼ì˜ìœ¼ë¡œ HP íšŒë³µ"
  town: "ë§ˆì„ ê·€í™˜ ì‹œ ì™„ì „ íšŒë³µ (HP + ë¶€í™œ)"
```

## UI ìš”êµ¬ì‚¬í•­

### ì „íˆ¬ í™”ë©´

```yaml
must_display:
  - 3Ã—3 ê·¸ë¦¬ë“œ (ì•„êµ°/ì êµ°)
  - ê° ì˜ì›… HP ë°”
  - ì˜ì›… ì´ˆìƒí™” ë° ì†ì„± ì•„ì´ì½˜
  - ì˜ì›… ê¸°ë¬¼(ê³µê²©í˜•, ë°©ì–´í˜•, ìœ í‹¸í˜•)
  - ê³µê²© ì• ë‹ˆë©”ì´ì…˜(ê³µê²©í˜•-ì›ê±°ë¦¬ & í™œ, ë°©ì–´í˜•-ê·¼ê±°ë¦¬ & ê²€, ë°©íŒ¨, ìœ í‹¸í˜•-ì›ê±°ë¦¬ & ì§€íŒ¡ì´)
  - ë¼ìš´ë“œ ì¹´ìš´í„°

actions:
  - ìŠ¤í‚µ (ê²°ê³¼ë§Œ ë³´ê¸°)
  - ë¦¬í”Œë ˆì´ (ì „íˆ¬ ì¬ìƒ)
  - ì†ë„ ì¡°ì ˆ (1x, 2x, 3x)
```

### ì „íˆ¬ ê²°ê³¼

```yaml
result_screen:
  summary:
    - ìŠ¹ë¦¬/íŒ¨ë°°/ë¬´ìŠ¹ë¶€
    - ìƒì¡´ì ëª©ë¡
    - ì‚¬ë§ì ëª©ë¡

  rewards:
    - íšë“ ê²½í—˜ì¹˜ (ì˜ì›…ë³„)
    - ë“œë ì•„ì´í…œ ëª©ë¡
    - ê³¨ë“œ íšë“

  stats:
    - ì´ ë°ë¯¸ì§€
    - ë¼ìš´ë“œ ìˆ˜
    - MVP (ìµœë‹¤ ë°ë¯¸ì§€)
```

## ì‹œìŠ¤í…œ ì—°ë™

### ì˜ì¡´ ì‹œìŠ¤í…œ
- `character.md` - ì˜ì›… ìŠ¤íƒ¯, ì†ì„±
- `equipment.md` - ì¥ë¹„ íš¨ê³¼ ì ìš©
- `encounter.md` - ì „íˆ¬ ì§„ì… ì¡°ê±´

### ì œê³µ ê¸°ëŠ¥
- ì „íˆ¬ ê²°ê³¼ (ìŠ¹/íŒ¨)
- ê²½í—˜ì¹˜ ë³´ìƒ
- ë“œë ì•„ì´í…œ
- ì˜ì›… ìƒíƒœ ë³€í™” (HP, ì‚¬ë§)

## ë°ì´í„° êµ¬ì¡°

> ì „íˆ¬ ê´€ë ¨ ë°ì´í„° êµ¬ì¡°ëŠ” `docs/04-technical/data-structures.md`ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.

ì£¼ìš” ê°œë…:
- **Combat**: ì „íˆ¬ ì„¸ì…˜ ì •ë³´ (ì°¸ê°€ì, ê·¸ë¦¬ë“œ ë°°ì¹˜, ë¼ìš´ë“œ)
- **CombatAction**: ê° í–‰ë™ ë¡œê·¸ (ê³µê²©ì, ëŒ€ìƒ, ë°ë¯¸ì§€)
- **CombatResult**: ì „íˆ¬ ê²°ê³¼ (ìŠ¹íŒ¨, ìƒì¡´ì, ë³´ìƒ)

## ë°¸ëŸ°ìŠ¤ íŒŒë¼ë¯¸í„°

```yaml
damage_formula:
  base: "attack - defense"
  min_damage: 1
  element_bonus: 0.3  # Â±30%

round_limit:
  normal: 10
  penalty_start: 11
  penalty_increase: 0.1  # 10% per round

exp_scaling:
  base_exp: "monster_level * 10"
  party_penalty: false  # ë¶„ë°°ë§Œ, ì´ëŸ‰ ê°ì†Œ ì—†ìŒ
```

## í™•ì¥ ê°€ëŠ¥ì„±

```yaml
future_features:
  - ìŠ¤í‚¬ ì‹œìŠ¤í…œ (íŒ¨ì‹œë¸Œë§Œ)
  - ìƒíƒœ íš¨ê³¼ (í™”ìƒ, ë¹™ê²° ë“±)
  - í¬ì§€ì…˜ íŠ¹í™” (ì „ì—´, í›„ì—´ ë³´ë„ˆìŠ¤)
  - ì½¤ë³´ ì‹œìŠ¤í…œ
```

## êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] 3Ã—3 ê·¸ë¦¬ë“œ ë Œë”ë§
- [ ] ì „íˆ¬ ë¡œì§ êµ¬í˜„
- [ ] ì†ì„± ìƒì„± ê³„ì‚°
- [ ] ê²½í—˜ì¹˜ ë¶„ë°°
- [ ] ë“œë ì‹œìŠ¤í…œ
- [ ] ì „íˆ¬ ë¡œê·¸ ê¸°ë¡
- [ ] ë¦¬í”Œë ˆì´ ê¸°ëŠ¥
- [ ] ìŠ¤í‚µ ê¸°ëŠ¥

---
**ìµœì¢… ìˆ˜ì •**: 2025-10-18
**ìƒíƒœ**: ğŸ”´ ì´ˆì•ˆ
**ì‘ì„±ì**: SangHyeok
